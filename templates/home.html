<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Manifest PWA -->
    <link rel="manifest" href="/manifest.json" />

    <!-- Theme color -->
    <meta name="theme-color" content="#667eea" />

    <!-- iOS PWA settings -->
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <link rel="apple-touch-icon" href="/icon-512.css" />

    <title>SuperBot</title>

    <!-- Icona CSS (simula immagine 512x512) -->
    <style>
        .app-icon {
            width: 512px;
            height: 512px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 20%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 150px;
            font-weight: bold;
            margin: auto;
        }
        #installBtn {
            display: none;
            padding: 12px 20px;
            background:#667eea;
            color:#fff;
            border:none;
            border-radius:10px;
            margin:20px auto;
            display:block;
            font-size:18px;
        }
    </style>
</head>

<body>
    <h1>SuperBot</h1>

    <!-- Bottone installazione PWA -->
    <button id="installBtn">Install App</button>

    <!-- Interfaccia chat -->
    <div id="chatbox" 
        style="width:90%;margin:20px auto;padding:15px;border:1px solid #ccc;border-radius:10px;min-height:300px;">
        <p><i>Inizia a chattareâ€¦</i></p>
    </div>

    <form method="POST" action="/chat" style="text-align:center;">
        <input type="text" name="message" placeholder="Scrivi..." style="width:70%;padding:10px;">
        <button type="submit">Invia</button>
    </form>

    <script>
        // Service Worker
        if ("serviceWorker" in navigator) {
            navigator.serviceWorker.register("/service-worker.js");
        }

        // Install prompt
        let deferredPrompt;
        const installBtn = document.getElementById("installBtn");

        window.addEventListener("beforeinstallprompt", (e) => {
            e.preventDefault();
            deferredPrompt = e;
            installBtn.style.display = "block";
        });

        installBtn.addEventListener("click", async () => {
            installBtn.style.display = "none";
            deferredPrompt.prompt();
            await deferredPrompt.userChoice;
            deferredPrompt = null;
        });
    </script>
</body>
</html>
